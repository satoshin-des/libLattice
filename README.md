# C_lattice_lib

## What is This?

This is a C-language library to easily use lattices(e.g. lattice basis reduction, solving (approx-)SVP, and etc.)

## How to Use?

First, to use this library, you must execute ``make`` command to make ``.so`` file.

```shell
gcc -shared -o libclat.so -c clat.c -lm
```

If you execute ``make`` command to use ``.so`` file, you can use this library. As example, ``main.c`` file is boundled, and this file generates a random lattice basis, {LLL, Deep-LLL, "BKZ"}-reduces the lattice basis, solves shortest vector problem(SVP), and solves approx-CVP by Babai's nearest plane algorithm:


```shell
random basis
162 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
346 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
228 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
211 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
806 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
...
404 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0
446 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1

The shortest vector
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 

LLL-reduced basis
0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
-1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 1 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
...
0 0 0 0 0 0 0 -1 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0
1 0 0 0 0 0 0 0 0 -1 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1

DeepLLL-reduced basis
...

"Nanchatte"BKZ-reduced basis
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 
0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
...
0 0 0 0 0 0 0 0 0 -1 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 -1 0 0 0 0
0 -1 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 0 0 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0

Target vector
1475850751 596681895 1583382968 684877020 993358414 2146477153 1259893394 411073551 425108265 1338689168 892382134 720326128 1978734471 713486788 1721188223 2017733911 1587999172 1589912973 1059520554 2009332132 171810678 1271473379 918243512 1849913510 391444416 594507336 1500842784 1975424103 976595317 282244941 540559001 304962421 878926836 2123941969 989839441 1872285250 2122935474 102249187 135875153 400560091 1440938356 1028257288 1120886219 1272189179 1741744076 694590794 1142439443 1182259601 137020120 54476349 1044108085 308830798 1325949728 1962351597 11260660 1717394144 409375285 1512103445 1545334599 1385970602

Babai's vector
1475850751 596681895 1583382967 684877020 993358413 2146477154 1259893393 411073550 425108265 1338689168 892382134 720326128 1978734470 713486788 1721188223 2017733910 1587999171 1589912973 1059520553 2009332132 171810677 1271473379 918243512 1849913509 391444416 594507336 1500842783 1975424103 976595317 282244940 540559000 304962421 878926835 2123941969 989839441 1872285250 2122935473 102249187 135875153 400560091 1440938356 1028257287 1120886219 1272189179 1741744075 694590793 1142439443 1182259601 137020120 54476349 1044108085 308830797 1325949728 1962351596 11260659 1717394143 409375285 1512103444 1545334599 1385970602 

Deference vector
0 0 -1 0 -1 1 -1 -1 0 0 0 0 -1 0 0 -1 -1 0 -1 0 -1 0 0 -1 0 0 -1 0 0 -1 -1 0 -1 0 0 0 -1 0 0 0 0 -1 0 0 -1 -1 0 0 0 0 0 -1 0 -1 -1 -1 0 -1 0 0
```

### How to utilize the applications

#### Initialization

To initialize lattices, you have to use ``Lattice`` function, or ``random_lattice``:

```C
#include <stdio.h>
#include <stdlib.h>
#include "clat.h"

int main(){
    // Definition of Lattice
    long **b = (long **)malloc(10 * sizeof(long *));
    for(int i = 0, j; i < 10; ++i){
        b[i] = (long *)malloc(10 * sizeof(long));
        for(j = 0; j < 10; ++j) b[i][j] = rand();
    }

    lattice c = Lattice(b, 10, 10);

    print(c, "basis");
    return 0;
}
```

```sh
$ gcc test.c -L. -lclat -lm
$ ./a.out
1804289383 846930886 1681692777 1714636915 1957747793 424238335 719885386 1649760492 596516649 1189641421
1025202362 1350490027 783368690 1102520059 2044897763 1967513926 1365180540 1540383426 304089172 1303455736
35005211 521595368 294702567 1726956429 336465782 861021530 278722862 233665123 2145174067 468703135
1101513929 1801979802 1315634022 635723058 1369133069 1125898167 1059961393 2089018456 628175011 1656478042
1131176229 1653377373 859484421 1914544919 608413784 756898537 1734575198 1973594324 149798315 2038664370
1129566413 184803526 412776091 1424268980 1911759956 749241873 137806862 42999170 982906996 135497281
511702305 2084420925 1937477084 1827336327 572660336 1159126505 805750846 1632621729 1100661313 1433925857
1141616124 84353895 939819582 2001100545 1998898814 1548233367 610515434 1585990364 1374344043 760313750
1477171087 356426808 945117276 1889947178 1780695788 709393584 491705403 1918502651 752392754 1474612399
2053999932 1264095060 1411549676 1843993368 943947739 1984210012 855636226 1749698586 1469348094 1956297539
```

By using these function, you can initialize not only lattice basis, but also GSO-information.

#### Lattice Reduction
By using this library, you can compute Lagrange-reduced, LLL-reduces, deep LLL-reduced, PotLLL-reduced, or "BKZ"-reduced lattice basis. But "BKZ"-reduction algorithm that you can use in this library is not proper BKZ-reduction.

Below is an example of LLL-reduction:
```C
#include <stdio.h>
#include <stdlib.h>
#include "clat.h"

int main(){
    // Definition of Lattice
    long **b = (long **)malloc(10 * sizeof(long *));
    for(int i = 0, j; i < 10; ++i){
        b[i] = (long *)malloc(10 * sizeof(long));
        for(j = 0; j < 10; ++j) b[i][j] = rand() % 100 + 1;
    }

    lattice c = Lattice(b, 10, 10);
    print(c, "basis");
    puts("=======================");
    LLL(c, 0.99);
    print(c, "basis");
    return 0;
}
```

```sh
$ gcc test.c -L. -lclat -lm
$ ./a.out

84 87 78 16 94 36 87 93 50 22
63 28 91 60 64 27 41 27 73 37
12 69 68 30 83 31 63 24 68 36
30 3 23 59 70 68 94 57 12 43
30 74 22 20 85 38 99 25 16 71
14 27 92 81 57 74 63 71 97 82
6 26 85 28 37 6 47 30 14 58
25 96 83 46 15 68 35 65 44 51
88 9 77 79 89 85 4 52 55 100
33 61 77 69 40 13 27 87 95 40
=======================
-51 41 -23 -30 19 4 22 -3 -5 -1
51 30 22 -9 -4 -34 -17 -29 9 29
-6 -43 17 -2 -46 -25 -16 6 -54 22
-29 -24 15 59 -4 -23 18 10 -26 37
-26 -20 3 -40 -49 45 -12 40 -4 30
5 18 8 -22 49 8 -73 -23 5 -18
18 5 -46 -10 2 7 36 1 -52 35
30 -33 14 -9 24 14 14 -60 -22 -3
-8 35 6 -23 -25 55 8 -22 -51 11
-4 3 -62 -16 -48 7 -42 -15 19 16
```

Below is its checking figures:
```python
A = matrix(ZZ, [
    [84, 87, 78, 16, 94, 36, 87, 93, 50, 22],
    [63, 28, 91, 60, 64, 27, 41, 27, 73, 37],
    [12, 69, 68, 30, 83, 31, 63, 24, 68, 36],
    [30, 3, 23, 59, 70, 68, 94, 57, 12, 43],
    [30, 74, 22, 20, 85, 38, 99, 25, 16, 71],
    [14, 27, 92, 81, 57, 74, 63, 71, 97, 82],
    [6, 26, 85, 28, 37, 6, 47, 30, 14, 58],
    [25, 96, 83, 46, 15, 68, 35, 65, 44, 51],
    [88, 9, 77, 79, 89, 85, 4 ,52, 55, 100],
    [33, 61, 77, 69, 40, 13, 27, 87, 95, 40],
])

print(A.LLL(0.99))
```

```sh
$ sage test.sage
[-51  41 -23 -30  19   4  22  -3  -5  -1]
[ 51  30  22  -9  -4 -34 -17 -29   9  29]
[ -6 -43  17  -2 -46 -25 -16   6 -54  22]
[-29 -24  15  59  -4 -23  18  10 -26  37]
[-26 -20   3 -40 -49  45 -12  40  -4  30]
[  5  18   8 -22  49   8 -73 -23   5 -18]
[ 18   5 -46 -10   2   7  36   1 -52  35]
[ 30 -33  14  -9  24  14  14 -60 -22  -3]
[ -8  35   6 -23 -25  55   8 -22 -51  11]
[ -4   3 -62 -16 -48   7 -42 -15  19  16]
```